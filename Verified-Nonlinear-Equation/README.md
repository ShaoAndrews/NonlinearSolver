# 非線形方程式の全解探索について(寻找非线性方程所有解)
> 实现kv library实验方法
[http://verifiedby.me/kv/allsol/allsol.pdf](http://verifiedby.me/kv/allsol/allsol.pdf)

## 引言
在数值计算中，在执行计算的同时会评估误差。
这样的方法被统称为具有保证精度的数值计算，并且近年来已经取得了飞速的进步。
使用区间计算是实现数值计算的最基本，最重要的技术之一。
区间计算是一种浮点计算，可将实数值转换为两个下限[下限，上限]。
用区间表示浮点数，并在区间之间进行加，减，乘，除等运算
包括可能的集合。”所以
计算区间的两端时，取整方向设为“向外”。
因此，可以在该部分中包括舍入误差的影响，并且可以掌握舍入误差。

在给定的有界域中应用区间计算可以找到多元非线性方程的根。有下面两个比较实用的工具：
+ 解存在性定理，例如Krawczyk方法（唯一的解存在于给定区间中）
+ 解不存在定理（在给定区间内没有解存在的充分条件）

尝试结合上面两个工具，如果两个定理都不成立，那么就将区域一分为二然后重新考虑。原理很简单，但是要稳定的执行此算法，有各种各样的技术。本文总结了其中一些技术。

## Krawczyk 方法
非线性方程求解
$$f(x)=0, \quad \mathbb{R}^n\to \mathbb{R}^n$$

## 解不存在定理
这很容易，比方说
$$0\notin f(I)$$
或者使用平均值格式
$$0\notin c + f'(I)(I-c)$$
以及使用前文提到的Krawczyk方法
$$K(I)\cap I = \varnothing$$

## 完整的全局搜索算法

将Krawczyk方法的解存在定理与解不存在定理结合起来，
通过递归划分区域直到定理
的所有解决方案都可以搜索。以下是伪代码

```matlab
function allsol(f , I0 ) {
    L = {I0 } # 关心的输入区域
    S = {} # 找到的解列表
    while (L is not empty) {
        I = L.pop() #取出第一个元素
        if (0　不属于　f(I)) continue # 解不存在
        c = mid(I)
        R ≃ f'(c) −1 # 近似逆
        M = E − Rf'(I)
        K = c − Rf(c) + M(I − c)
        if (K ∩ I = ∅) continue # 解不存在
        if (K ⊂ I and ∥M ∥ < 1) { # 解存在
        S.append(K) # 解のリストに追加
        continue
        }
        I1 , I2 = divide(K ∩ I) # K ∩ I 一分为二
        L.append(I1)
        L.append(I2)
    }
    return S
}
```
##　分割的边界问题

对于关心的区域$I$，如果解正好在边界上，根据Krawczyk方法，由于区间计算的过大估计，会导致$K(I)\subset I$和$K(I)\cap I =\varnothing$都不成立。所以如果解在边界上，即使将其划分，边界上仍然一直会存在一个解。所以按照该算法执行下去会进入无限循环的状态。比方说，如果$0$是一个解，那么如果我们在$[-2, 2]$的区间内搜索，那么首先会将其分成$[-2, 0]$和$[0, 2]$，自此以后，我们再也无法找到解$0$。

为了解决这个问题，我们引入常数$C>0$，对于测试范围$I$和Krawczyk映射的值，如果
$K(I)\subset I$和$K(I) \cap I = \varnothing$都不成立。那么如果
$$
\max_{i}\frac{width(K_i)}{width(I_i)}\leq C
$$
成立的话，那么将$K$作为下一个搜索范围，而不是$I$。如果与$I$相比$K(I)$足够小，但仍然不存在，那可能很可能是在边界或者边界附近。$C$根据经验值设定为0.9（没有任何理由）。




## 利用平均值格式

对于方程$f(x)=0$，会得到区域$I$的雅克比矩阵$f'(I)$的范围。假设固定一个$i$并且考虑第$i$个方程$f_i(x)=0$。那么对应$f_i$的平均值格式


## Krawczyk 算法告诉判定失败的条件

保证解存在的Krawczyk方法要求$f'(c)$是可逆的。但是逆矩阵的计算成本很高。如果我们能够在逆矩阵之前就能够知道$Krawczyk$方法不成立，跳过Krawczyk方法可以减少总体的计算时间。

Krawczyk仅仅使用f(c)和f'(I)的信息

